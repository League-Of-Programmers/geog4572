<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>panoramic photo</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" >
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!--<link rel="stylesheet" href="css/main.css">-->
    <style>
        #map {
            position:  fixed;
            width: 100%;
            top: 0;
            bottom: 50%;
            right: 0;
        }

        #pano {
            position: fixed;
            width: 100%;
            top: 50%;
            bottom: 0px;
            right: 0;
        }

        #pano img{
            display: none;
        }
    </style>
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript" src="js/exif.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="js/three.min.js"></script>
    <script src="js/photo-sphere-viewer.min.js"></script>
</head>
<body>

<div class="container">
    <div class="row">
        <div id="pano"><img src="img/DSCN0124.JPG"/></div>
        <div id="map"></div>
    </div>
</div>

<script>


	function getLatLng() {

		EXIF.getData($("img")[0], function () {

			var exif = EXIF.getAllTags(this);

			var latObj = exif.GPSLatitude;
			var lngObj = exif.GPSLongitude;

			//Convert coordinates to WGS84 decimal
			var latRef = exif.GPSLatitudeRef || "N";
			var lngRef = exif.GPSLongitudeRef || "W";
			var lat = (latObj[0] + latObj[1] / 60 + latObj[2] / 3600) * (latRef == "N" ? 1 : -1);
			var lng = (lngObj[0] + lngObj[1] / 60 + lngObj[2] / 3600) * (lngRef == "W" ? -1 : 1);
			var latlng = L.latLng(lat, lng);

			L.marker(latlng).addTo(map);

			new PhotoSphereViewer({
				panorama: 'img/DSCN0124.JPG',
				container: $("#pano")[0],
				navbar: true
			});


		});
	}

	window.onload=getLatLng;
	var map = L.map('map', {zoomControl: false, scrollWheelZoom: true}).setView([44, -122], 6);
	L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}@2x.png').addTo(map);

</script>
</body>
</html>
